<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D&D Combat Simulator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Lora:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="p-4 md:p-8">

    <header class="text-center mb-8 max-w-7xl mx-auto">
        <h1 class="title-font text-4xl md:text-5xl font-bold text-white">D&D Combat Simulator</h1>
        <p class="text-gray-400 mt-2">A comprehensive tool for testing D&D 5e encounter balance.</p>
        <p class="text-xs text-gray-500 mt-4">This website is unofficial Fan Content permitted under the Fan Content Policy. Not approved/endorsed by Wizards. Portions of the materials used are property of Wizards of the Coast. Â©Wizards of the Coast LLC.</p>
    </header>

    <div class="flex flex-col lg:flex-row gap-8 max-w-screen-2xl mx-auto">
        <!-- Main Content -->
        <main class="flex-grow">
            <!-- Combatant Setup -->
            <div class="grid grid-cols-1 xl:grid-cols-2 gap-8 mb-8">
                <!-- Team A -->
                <div id="team-a-panel" class="card space-y-4">
                    <h2 class="text-2xl title-font font-semibold text-blue-400 border-b border-gray-700 pb-2">Team A</h2>
                    <div id="team-a-list" class="space-y-2"></div>
                    <button data-action="open-add-editor" data-team="A" class="btn btn-secondary w-full">Add New Combatant</button>
                    <div class="grid grid-cols-2 gap-4">
                        <button data-action="save-team" data-team="A" class="btn btn-secondary w-full">Save Team</button>
                        <button data-action="load-team" data-team="A" class="btn btn-secondary w-full">Load Team</button>
                    </div>
                </div>

                <!-- Team B -->
                <div id="team-b-panel" class="card space-y-4">
                    <h2 class="text-2xl title-font font-semibold text-red-400 border-b border-gray-700 pb-2">Team B</h2>
                    <div id="team-b-list" class="space-y-2"></div>
                    <button data-action="open-add-editor" data-team="B" class="btn btn-secondary w-full">Add New Combatant</button>
                    <div class="grid grid-cols-2 gap-4">
                        <button data-action="save-team" data-team="B" class="btn btn-secondary w-full">Save Team</button>
                        <button data-action="load-team" data-team="B" class="btn btn-secondary w-full">Load Team</button>
                    </div>
                </div>
            </div>

            <!-- Simulation Controls -->
            <div class="card mb-8">
                <h2 class="text-2xl title-font font-semibold text-white mb-4">Simulation Controls</h2>
                <div class="flex flex-col sm:flex-row items-center gap-4">
                    <label for="simulation-count" class="font-semibold">Number of Simulations:</label>
                    <input type="number" id="simulation-count" value="1000" class="form-input w-full sm:w-48">
                    <button id="run-button" class="btn btn-primary w-full sm:w-auto flex-grow">Run Simulations</button>
                    <button id="reset-button" class="btn btn-secondary w-full sm:w-auto">Reset All</button>
                </div>
            </div>

            <!-- Results -->
            <div class="grid grid-cols-1 xl:grid-cols-3 gap-8">
                <div class="xl:col-span-1 card">
                    <h2 class="text-2xl title-font font-semibold text-white mb-4">Summary</h2>
                    <div id="simulation-summary" class="text-lg space-y-2"><p>Run a simulation to see the results.</p></div>
                </div>
                <div class="xl:col-span-2 card">
                    <h2 class="text-2xl title-font font-semibold text-white mb-4">Detailed Log (Last Run)</h2>
                    <div id="simulation-log" class="bg-gray-900 p-4 rounded-md h-96 overflow-y-auto font-mono text-sm leading-relaxed">
                        <p class="text-gray-500">The detailed log of the final simulation run will appear here.</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Editor Modal -->
    <div id="editor-modal-overlay" class="hidden fixed inset-0 bg-black bg-opacity-75 z-40"></div>
    <div id="editor-modal" class="hidden fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50 w-full max-w-4xl">
        <div id="editor-modal-content" class="card">
            <!-- Editor HTML will be injected here by ui.js -->
        </div>
    </div>

    <!-- Action Editor Modal (for Guided Builder) -->
    <div id="action-editor-modal-overlay" class="hidden fixed inset-0 bg-black bg-opacity-75 z-60"></div>
    <div id="action-editor-modal" class="hidden fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-70 w-full max-w-2xl">
        <div id="action-editor-modal-content" class="card">
            <!-- Action Editor Form will be injected here by ui.js -->
        </div>
    </div>

    <!-- Ability Editor Modal -->
    <div id="ability-editor-modal-overlay" class="hidden fixed inset-0 bg-black bg-opacity-75 z-60"></div>
    <div id="ability-editor-modal" class="hidden fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-70 w-full max-w-2xl">
        <div id="ability-editor-modal-content" class="card">
            <!-- Ability Editor will be injected here by ui.js -->
        </div>
    </div>

    <script src="js/conditions.js"></script>
    <script src="js/abilities.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/state.js"></script>
    <script src="js/data.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/simulation.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
